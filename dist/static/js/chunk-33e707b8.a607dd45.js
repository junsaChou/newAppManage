(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33e707b8"],{"07a1":function(e,t,i){},"206f":function(e,t,i){"use strict";var o=i("07a1"),a=i.n(o);a.a},"333d":function(e,t,i){"use strict";var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pagination-wrapper"},[i("el-pagination",{attrs:{background:e.background,"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,total:e.total,layout:e.layout},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},a=[],l=(i("a9e3"),{name:"Pagination",props:{page:{type:Number,default:1,required:!0},limit:{type:Number,default:10,required:!0},background:{type:Boolean,default:!0},pageSizes:{type:Array,default:function(){return[10,15,20,50]}},total:{type:Number,default:0,required:!0},layout:{type:String,default:"total, prev, pager, next, sizes, jumper"}},computed:{currentPage:{get:function(){return this.page},set:function(e){console.log(e),this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e})},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize})}}}),r=l,n=(i("206f"),i("2877")),s=Object(n["a"])(r,o,a,!1,null,null,null);t["a"]=s.exports},"6d98":function(e,t,i){},"731a":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"table-classic-wrapper"},[i("el-card",{attrs:{shadow:"always"}},[i("el-form",{ref:"searchForm",staticClass:"search-form",attrs:{inline:!0,model:e.listQuery,"label-width":"90px"}},[i("el-form-item",{attrs:{label:"优惠券名称"}},[i("el-input",{attrs:{placeholder:"请填写"},model:{value:e.listQuery.title,callback:function(t){e.$set(e.listQuery,"title",t)},expression:"listQuery.title"}})],1),i("el-form-item",{attrs:{label:"适用范围"}},[i("el-select",{model:{value:e.listQuery.type,callback:function(t){e.$set(e.listQuery,"type",t)},expression:"listQuery.type "}},[i("el-option",{attrs:{value:"",label:"全部"}}),i("el-option",{attrs:{value:0,label:"充值"}}),i("el-option",{attrs:{value:1,label:"抵扣"}})],1)],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("搜索")]),i("el-button",{attrs:{type:"warning"},on:{click:e.onReset}},[e._v("重置")])],1)],1),i("div",{staticClass:"control-btns"},[i("el-button",{attrs:{type:"primary"},on:{click:e.handleCreate}},[e._v("新增优惠券")])],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark",size:"medium"}},[i("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"id",label:"序号",align:"center",width:"90",sortable:""}}),i("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"title",label:"优惠券名称",align:"center"}}),i("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"usedAmount",label:"面额",align:"center"}}),i("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"withAmount",label:"满减额度",align:"center"}}),i("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"适用范围",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s("0"==t.row.type?"充值":"抵扣"))]}}])}),i("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"添加时间",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("formatDate")(t.row.createTime)))])]}}])}),i("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"有效期",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.validType?i("span",[e._v(e._s(e._f("formatDate")(t.row.validStartTime))+"-"+e._s(e._f("formatDate")(t.row.validEndTime)))]):i("span",[e._v(e._s(t.row.validDays)+"天")])]}}])}),i("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),i("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(i){return e.handleGiveOutCoupon(t.$index,t.row.id)}}},[e._v("发放")]),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return e.handleDelete(t.$index,t.row.id)}}},[e._v("删除")])]}}])})],1),i("Pagination",{attrs:{total:e.total,page:e.listQuery.pageIndex,limit:e.listQuery.pageSize},on:{"update:page":function(t){return e.$set(e.listQuery,"pageIndex",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.PostFetchData}}),i("el-dialog",{staticClass:"dialog-form",attrs:{title:e.formVisibleList.title,visible:e.formVisibleList.formVisible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){return e.$set(e.formVisibleList,"formVisible",t)}}},[i("el-form",{ref:"dialogForm",attrs:{model:e.dialogForm,rules:e.formRules,"label-width":"110px"}},[i("el-form-item",{attrs:{label:"优惠券名称：",prop:"title"}},[i("el-input",{model:{value:e.dialogForm.title,callback:function(t){e.$set(e.dialogForm,"title",t)},expression:"dialogForm.title"}})],1),i("el-form-item",{attrs:{label:"优惠券面额：",prop:"usedAmount"}},[i("el-input",{model:{value:e.dialogForm.usedAmount,callback:function(t){e.$set(e.dialogForm,"usedAmount",t)},expression:"dialogForm.usedAmount"}})],1),i("el-form-item",{attrs:{label:"满减额度：",prop:"withAmount"}},[i("el-input",{model:{value:e.dialogForm.withAmount,callback:function(t){e.$set(e.dialogForm,"withAmount",t)},expression:"dialogForm.withAmount"}})],1),i("el-form-item",{attrs:{label:"优惠券有效期："}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-text":"固定天数","inactive-text":"日期范围"},model:{value:e.dialogForm.validType,callback:function(t){e.$set(e.dialogForm,"validType",t)},expression:"dialogForm.validType "}})],1),0==e.dialogForm.validType?i("el-form-item",{attrs:{label:"日期范围：",prop:"dateTime"}},[i("el-date-picker",{attrs:{type:"datetimerange","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},on:{change:e.changePicker},model:{value:e.dialogForm.dateTime,callback:function(t){e.$set(e.dialogForm,"dateTime",t)},expression:"dialogForm.dateTime"}})],1):i("el-form-item",{attrs:{label:"固定天数：",prop:"validDays"}},[i("el-input",{model:{value:e.dialogForm.validDays,callback:function(t){e.$set(e.dialogForm,"validDays",t)},expression:"dialogForm.validDays"}})],1),i("el-form-item",{attrs:{label:"适用范围：",prop:"type"}},[i("el-radio-group",{model:{value:e.dialogForm.type,callback:function(t){e.$set(e.dialogForm,"type",t)},expression:"dialogForm.type "}},[i("el-radio",{attrs:{label:0}},[e._v("充值")]),i("el-radio",{attrs:{label:1}},[e._v("抵扣")])],1)],1),i("div",{staticClass:"footer-item"},[i("el-button",{on:{click:e.cancleForm}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",disabled:e.isSubmit},on:{click:function(t){return e.submitForm("dialogForm",e.formVisibleList.isCreate)}}},[e._v("确 定")])],1)],1)],1),i("el-dialog",{staticClass:"dialog-form",attrs:{title:"优惠券发放规则",visible:e.formVisible,width:"45%","before-close":e.handleCloseCoupon},on:{"update:visible":function(t){e.formVisible=t}}},[i("el-form",{ref:"dialogCouponForm",attrs:{model:e.dialogCouponForm,rules:e.formRules,"label-width":"110px"}},[i("el-form-item",{attrs:{label:"发放时间：",prop:"giveOutTime"}},[i("el-date-picker",{attrs:{type:"datetime","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间",align:"right"},on:{change:e.changePicker},model:{value:e.dialogCouponForm.giveOutTime,callback:function(t){e.$set(e.dialogCouponForm,"giveOutTime",t)},expression:"dialogCouponForm.giveOutTime"}})],1),i("el-form-item",{attrs:{label:"发放用户：",prop:"userType"}},[i("el-radio-group",{model:{value:e.dialogCouponForm.userType,callback:function(t){e.$set(e.dialogCouponForm,"userType",t)},expression:"dialogCouponForm.userType "}},[i("el-radio",{attrs:{label:0}},[e._v("全体用户")]),i("el-radio",{attrs:{label:1}},[e._v("部分用户")])],1)],1),1==e.dialogCouponForm.userType?i("el-form-item",{attrs:{label:"请输入经理手机号码：",prop:"userListPhone"}},[i("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},model:{value:e.dialogCouponForm.userListPhone,callback:function(t){e.$set(e.dialogCouponForm,"userListPhone",t)},expression:"dialogCouponForm.userListPhone"}})],1):e._e(),i("div",{staticClass:"footer-item"},[i("el-button",{on:{click:e.cancleFormCoupon}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",disabled:e.isSubmit},on:{click:function(t){return e.submitFormCoupon("dialogCouponForm")}}},[e._v("确 定")])],1)],1)],1)],1)],1)},a=[],l=(i("4160"),i("a9e3"),i("b64b"),i("d3b7"),i("ac1f"),i("6062"),i("3ca3"),i("1276"),i("159b"),i("ddb0"),i("2909")),r=i("058a"),n=i("fdf9"),s=i("333d"),u=i("8a1f"),d={name:"Table",components:{Pagination:s["a"]},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},listLoading:!0,listQuery:{title:null,type:null,pageIndex:1,pageSize:10},dialogForm:{title:null,usedAmount:null,withAmount:null,validDays:null,validEndTime:"",validStartTime:"",validType:"0",type:0,dateTime:null,id:null},dialogCouponForm:{couponId:null,giveOutTime:null,id:null,userListId:null,userListPhone:null,userType:0},total:0,tableData:[],multipleSelection:[],formVisible:!1,formVisibleList:{formVisible:!1,title:"编辑",isCreate:!1},formRules:{title:[{required:!0,message:"请输入优惠券名称",trigger:"blur"},{validator:n["a"].validateCouponTitle,trigger:"blur"}],usedAmount:[{required:!0,message:"请输入数字",trigger:"blur"},{validator:n["a"].validateNumberMaxReg,trigger:"blur"}],withAmount:[{required:!0,message:"请输入数字",trigger:"blur"},{validator:n["a"].validateWithAmount,trigger:"blur"}],validDays:[{required:!0,message:"请输入数字",trigger:"blur"},{validator:n["a"].validateWithAmount,trigger:"blur"}],dateTime:[{required:!0,message:"请输入时间范围并不能是过去时间",trigger:"blur"}],giveOutTime:[{required:!0,message:"请输入时间",trigger:"blur"}],userListPhone:[{required:!0,message:"请输入手机号",trigger:"blur"}],endTime:[{required:!0,message:"请输入结束时间",trigger:"blur"}],type:[{required:!0,message:"请选择用户账户状态：",trigger:"change"}]},isSubmit:!1,importVisible:!1}},created:function(){this.PostFetchData()},methods:{handleEdit:function(e,t){this.formVisibleList.title="编辑",console.log(t),this.formVisibleList.isCreate=!1,this.dialogForm.title=t.title,this.dialogForm.usedAmount=t.usedAmount,this.dialogForm.withAmount=t.withAmount,this.dialogForm.validDays=t.validDays,this.dialogForm.validType=String(t.validType),console.log(this.dialogForm.validType),this.dialogForm.type=t.type,this.dialogForm.id=t.id,null!=t.validStartTime&&(this.dialogForm.validEndTime=this.$options.filters["FormatDate"](t.validEndTime),this.dialogForm.validStartTime=this.$options.filters["FormatDate"](t.validStartTime),this.dialogForm.dateTime=[],this.dialogForm.dateTime[0]=this.dialogForm.validStartTime,this.dialogForm.dateTime[1]=this.dialogForm.validEndTime),console.log(this.dialogForm),this.formVisibleList.formVisible=!0},handleGiveOutCoupon:function(e,t){this.formVisible=!0,this.dialogCouponForm.couponId=t,console.log(t)},InitGiveOutCoupon:function(e){var t=this;console.log(e),Object(r["J"])(e).then((function(e){console.log(e),200===e.code?(t.$message({type:"success",message:"优惠券发放成功！"}),t.cancleFormCoupon()):t.$message({type:"warning",message:e.message})})).catch((function(e){console.log(e),t.listLoading=!1}))},handleDelete:function(e,t){var i=this;console.log(e,t),this.$confirm("此操作将删除选中数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.deleteApi(t),i.$message({type:"success",message:"删除成功!"})})).catch((function(){i.$message({type:"info",message:"已取消删除"})}))},deleteApi:function(e){var t=this,i={couponId:e};Object(r["k"])(i).then((function(e){console.log(e),200===e.code?t.PostFetchData():t.$message({type:"warning",message:e.message})})).catch((function(e){console.log(e),t.listLoading=!1}))},handleClose:function(){this.cancleForm()},handleCloseCoupon:function(){this.cancleFormCoupon()},handleCreate:function(){this.formVisibleList.formVisible=!0,this.formVisibleList.title="创建",this.formVisibleList.isCreate=!0},PostFetchData:function(){var e=this;this.listLoading=!0;var t=this.listQuery;Object(r["z"])(t).then((function(t){console.log(t),200===t.code&&(e.total=t.data.total,e.tableData=t.data.list,e.listLoading=!1)})).catch((function(t){console.log(t),e.listLoading=!1}))},onSubmit:function(){this.PostFetchData()},onReset:function(){var e=this;Object.keys(e.listQuery).forEach((function(t){e.listQuery[t]=null})),this.listQuery.pageIndex=1,this.listQuery.pageSize=10,this.PostFetchData()},submitFormCoupon:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var i={};if(t.dialogCouponForm.userType>0){var o=t.dialogCouponForm.userListPhone.split("\n");o=Object(l["a"])(new Set(o));var a=!1;if(o.length>300)return t.$message({type:"warning",message:"最多只能输入300位手机号！"}),!1;if(o.forEach((function(e){Object(u["a"])(e)||(t.$message({type:"warning",message:"请输入正确的手机号码"}),a=!0)})),a)return!1;t.dialogCouponForm.id=o,i["userListPhone"]=t.dialogCouponForm.id}else t.dialogCouponForm.userListPhone=null,t.dialogCouponForm.id=null;i["userType"]=t.dialogCouponForm.userType,i["couponId"]=t.dialogCouponForm.couponId,i["giveOutTime"]=t.dialogCouponForm.giveOutTime,t.InitGiveOutCoupon(i)}}))},submitForm:function(e,t){var i=this;this.$refs[e].validate((function(e){if(e){if(Number(i.dialogForm.withAmount)<Number(i.dialogForm.usedAmount))return i.$message({type:"warning",message:"满减金额须大于优惠券面额"}),!1;if(i.dialogForm.validType>0){if(i.dialogForm.validDays>365)return i.$message({type:"warning",message:"固定天数须小于365天"}),!1;i.dialogForm.validStartTime=null,i.dialogForm.validEndTime=null,i.dialogForm.dateTime=null}else i.dialogForm.validDays=null;return!1}return i.isSubmit=!1,!1}))},cancleForm:function(){var e=this;Object.keys(this.dialogForm).forEach((function(t){e.dialogForm[t]=null})),this.dialogForm.validType="0",this.dialogForm.type=0,this.formVisibleList.formVisible=!1},cancleFormCoupon:function(){var e=this;Object.keys(this.dialogCouponForm).forEach((function(t){e.dialogCouponForm[t]=null})),this.dialogCouponForm.userType=0,this.formVisible=!1},changePicker:function(e){e?(this.dialogForm.validStartTime=e[0],this.dialogForm.validEndTime=e[1]):(this.dialogForm.validStartTime=null,this.dialogForm.validEndTime=null)}}},m=d,c=(i("b9c1"),i("2877")),g=Object(c["a"])(m,o,a,!1,null,null,null);t["default"]=g.exports},"8a1f":function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return a}));i("c975"),i("ac1f"),i("1276"),i("498a");function o(e){return/^1[0-9]{10}$/.test(e)}function a(e){var t=/^[0-9A-Za-z]+$/;return t.test(e)}},b9c1:function(e,t,i){"use strict";var o=i("6d98"),a=i.n(o);a.a},fdf9:function(e,t,i){"use strict";var o=/^[0-9]{1,2}$/,a=/^[0-9]{1,5}$/,l=/^[1-9][0-9]{0,5}$/,r=/^[\u4e00-\u9fa5]+$/,n=/^[\u4e00-\u9fa5]{2,10}$/,s=/^[A-Za-z0-9\u4e00-\u9fa5]{2,16}$/,u=/^[A-Za-z0-9]{2,16}$/,d=/^[A-Za-z0-9\u4e00-\u9fa5]+$/,m=/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/,c=/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/,g=/^[1][3,4,5,6,7,8,9][0-9]{9}$/;t["a"]={validateNumber:function(e,t,i){o.test(t)?i():i(new Error("请输入数字"))},validateNumberMaxReg:function(e,t,i){a.test(t)?i():i(new Error("请输入最大五位数字"))},validateWithAmount:function(e,t,i){a.test(t)?i():i(new Error("请输入最大五位数字"))},validateRechargeReg:function(e,t,i){l.test(t)?i():i(new Error("请输入1-999999的数额"))},validateNumbetAcReg:function(e,t,i){u.test(t)?i():i(new Error("请输入英文与数字的格式"))},validateUserName:function(e,t,i){n.test(t)?i():i(new Error("请输入中文"))},validateCouponTitle:function(e,t,i){s.test(t)?i():i(new Error("请输入16位以内标题"))},validateCn:function(e,t,i){r.test(t)?i():i(new Error("请输入中文"))},validateEmail:function(e,t,i){c.test(t)?i():i(new Error("请输入正确的邮箱"))},validatePhone:function(e,t,i){console.log(t),g.test(t)?i():i(new Error("请输入正确的手机号码"))},validateUrl:function(e,t,i){m.test(t)?i():i(new Error("请输入正确url格式"))},validateIsUrl:function(e,t,i){d.test(t)?i():i(new Error("请输入正确url格式"))},validateNumberAcCn:function(e,t,i){d.test(t)?i():i(new Error("请输入中文数字字母的格式"))},validateDivide70:function(e,t,i){t%70!=0?i(new Error("请输入70的倍数")):i()}}}}]);